<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>新的记录单模板原始备份</title>
    <style>
        p {
            margin: 0
        }

        .record {
            width: 100%;
            height: 100%;
            margin: auto;
            font-family: '宋体'
        }

        .title {
            margin: 0 0 20px 0;
            text-align: center;
            font-size: 35px
        }

        .baseInfoLeft > p {
            margin: 0 10px 0 0
        }

        .dept {
            width: 150px;
            overflow: hidden;
            white-space: nowrap
        }

        .name {
            width: 130px;
            overflow: hidden;
            text-overflow: ellipsis;
            white-space: nowrap
        }

        .bedNo {
            width: 80px;
            overflow: hidden;
            white-space: nowrap
        }

        .diagnosis {
            width: 100%;
            overflow: hidden;
            text-overflow: ellipsis;
            white-space: nowrap
        }

        .secondRow > p {
            margin-right: 40px;
        }

        table {
            border-collapse: collapse;
            width: 100%;
            table-layout: fixed;
        }

        td {
            word-wrap: break-word;
            word-break: break-all;
            white-space: pre-line;
            border: 1px solid #000;
            padding: 0;
            text-align: center;
            font-size: 15px;
            line-height: 30px;
        }

        tbody td:nth-last-child(2) {
            text-align: left
        }

        tbody td {
            line-height: 30px;
        }

        .baseAuto > a {
            float: left;
        }

        #baseTable td {
            text-align: left;
        }

        .logo {
            width: 100%;
            display: flex;
            justify-content: space-around;
            font-size: 20px;
        }

        a {
            position: absolute;
            right: 0;
            top: 30px;
        }

        .tdCol {
            border-bottom: none;
            border-right: none;
            border-left: none;
            line-height: 0;
        }

        .nurseUser {
            position: absolute;
            right: 5px;
            bottom: 30px;
        }
    </style>
</head>
<body>
<div class="record">
    <div class="print-header">
        <div class="logo">
            <span>重庆市急救医疗中心</span>
            <span>重庆市第四人民医院</span>
        </div>
        <h4 class="title">
            护理记录单
        </h4>
        <table id="baseTable">
            <tr>
                <td colspan="1" style="width: 50px">科室</td>
                <td colspan="2" style="width: 68px"><span class="dept dot-format"></span></td>
                <td colspan="1" style="width: 58px">留观号</td>
                <td colspan="2" style="width: 118px"><span class="viewNo dot-format"></span></td>
                <td colspan="1" style="width: 50px">床号</td>
                <td colspan="2" style="width: 85px"><span class="bedNo dot-format"></span></td>
                <td colspan="2" style="width: 165px">入观时间</td>
                <td colspan="3" style="width: 180px"><span class="admWardDateTime dot-format"></span></td>
                <td colspan="2">出观时间</td>
                <td colspan="4" style="width: 150px"><span class="disWardDateTime dot-format"></span></td>
            </tr>
            <tr>
                <td colspan="1">姓名</td>
                <td colspan="2"><span class="name dot-format"></span></td>
                <td colspan="1">性别</td>
                <td colspan="2"><span class="sex dot-format"></span></td>
                <td colspan="1">年龄</td>
                <td colspan="2"><span class="age dot-format"></span></td>
                <td colspan="2">日期</td>
                <td colspan="9"><span class="dateTime dot-format"></span></td>
            </tr>
            <tr>
                <td colspan="1">诊断</td>
                <td colspan="19"><span class="diagnosis dot-format"></span></td>
            </tr>
            <tr>
                <td colspan="1" style="border-bottom: none ">病情</td>
                <td colspan="19" style="border-bottom: none "><span class="mainComplaint dot-format"></span></td>
            </tr>
        </table>
    </div>
    <table id="tableInfo" class="dot-format">
        <thead class="tableTitle dot-format">
        </thead>
        <tbody class="tableBody dot-format">
        </tbody>
        <tfoot class="tableFoot dot-format">
        <tr>
            <td class="tdCol">
                <span class="nurseUser">审核护士:____________</span>
            </td>
        </tr>
        </tfoot>
    </table>
</div>
<script>
    let data = {
        signFlag: 1,
        data: [{
            COL11: "2018-11-01",
            COL2: "36.5",
            COL3: "120",
            COL1: "14:27",
            COL6: "35",
            COL7: " ",
            COL4: "80",
            COL5: "120/105",
            COL8: " ",
            SIGN: "xxk",
            COL9: "病情蒸汽引起特指急性和亚急"
        }, {
            COL11: " ",
            COL2: " ",
            COL3: " ",
            COL1: " ",
            COL6: " ",
            COL7: " ",
            COL4: " ",
            COL5: " ",
            COL8: " ",
            COL9: "气体、烟雾和蒸汽引起特指急",
            SIGN: "xxk"
        }, {
            COL11: " ",
            COL2: " ",
            COL3: " ",
            COL1: " ",
            COL6: " ",
            COL7: " ",
            COL4: " ",
            COL5: " ",
            COL8: " ",
            COL9: "性和亚急气体、烟雾和蒸汽引",
            SIGN: "xxk"
        }, {
            COL11: " ",
            COL2: " ",
            COL3: " ",
            COL1: " ",
            COL6: " ",
            COL7: " ",
            COL4: " ",
            COL5: " ",
            COL8: " ",
            COL9: "起特指急性和亚急气体、烟雾",
            SIGN: "xxk"
        }, {
            COL11: " ",
            COL2: " ",
            COL3: " ",
            COL1: " ",
            COL6: " ",
            COL7: " ",
            COL4: " ",
            COL5: " ",
            COL8: " ",
            COL9: "和蒸汽引",
            SIGN: "xxk"
        }, {
            COL11: "2018-11-05",
            COL2: " ",
            COL3: " ",
            COL1: "14:28",
            COL6: " ",
            COL7: " ",
            COL4: " ",
            COL5: " ",
            COL8: " ",
            SIGN: "xxk",
            COL9: "化学制剂、气体、烟雾和蒸汽"
        }, {
            COL11: " ",
            COL2: " ",
            COL3: " ",
            COL1: " ",
            COL6: " ",
            COL7: " ",
            COL4: " ",
            COL5: " ",
            COL8: " ",
            COL9: "引起蒸汽引起特指急性和亚急",
            SIGN: "xxk"
        }, {
            COL11: " ",
            COL2: " ",
            COL3: " ",
            COL1: " ",
            COL6: " ",
            COL7: " ",
            COL4: " ",
            COL5: " ",
            COL8: " ",
            COL9: "气体、烟雾和蒸汽引起特指急",
            SIGN: "xxk"
        }, {
            COL11: " ",
            COL2: " ",
            COL3: " ",
            COL1: " ",
            COL6: " ",
            COL7: " ",
            COL4: " ",
            COL5: " ",
            COL8: " ",
            COL9: "性和亚急气体、烟雾和蒸汽引",
            SIGN: "xxk"
        }, {
            COL11: " ",
            COL2: " ",
            COL3: " ",
            COL1: " ",
            COL6: " ",
            COL7: " ",
            COL4: " ",
            COL5: " ",
            COL8: " ",
            COL9: "起特指急性和亚急气体、烟雾",
            SIGN: "xxk"
        }, {
            COL11: " ",
            COL2: " ",
            COL3: " ",
            COL1: " ",
            COL6: " ",
            COL7: " ",
            COL4: " ",
            COL5: " ",
            COL8: " ",
            COL9: "和蒸汽引起特指特指急性和亚",
            SIGN: "xxk"
        }, {
            COL11: " ",
            COL2: " ",
            COL3: " ",
            COL1: " ",
            COL6: " ",
            COL7: " ",
            COL4: " ",
            COL5: " ",
            COL8: " ",
            COL9: "急性呼吸性情",
            SIGN: "xxk"
        }, {
            COL11: "2018-11-28",
            COL2: " ",
            COL3: " ",
            COL1: "16:27",
            COL6: " ",
            COL7: " ",
            COL4: " ",
            COL5: " ",
            COL8: " ",
            SIGN: "xxk",
            COL9: "烟雾和蒸汽引起特指急性和亚"
        }, {
            COL11: " ",
            COL2: " ",
            COL3: " ",
            COL1: " ",
            COL6: " ",
            COL7: " ",
            COL4: " ",
            COL5: " ",
            COL8: " ",
            COL9: "急气体、烟雾和蒸汽引起特指",
            SIGN: "xxk"
        }, {
            COL11: " ",
            COL2: " ",
            COL3: " ",
            COL1: " ",
            COL6: " ",
            COL7: " ",
            COL4: " ",
            COL5: " ",
            COL8: " ",
            COL9: "急性和亚急气体、烟雾和蒸汽",
            SIGN: "xxk"
        }, {
            COL11: " ",
            COL2: " ",
            COL3: " ",
            COL1: " ",
            COL6: " ",
            COL7: " ",
            COL4: " ",
            COL5: " ",
            COL8: " ",
            COL9: "引起特指特指急性和亚急性呼",
            SIGN: "xxk"
        }, {
            COL11: " ",
            COL2: " ",
            COL3: " ",
            COL1: " ",
            COL6: " ",
            COL7: " ",
            COL4: " ",
            COL5: " ",
            COL8: " ",
            COL9: "吸性情况病情:病情蒸汽引起特",
            SIGN: "xxk"
        }, {
            COL11: " ",
            COL2: " ",
            COL3: " ",
            COL1: " ",
            COL6: " ",
            COL7: " ",
            COL4: " ",
            COL5: " ",
            COL8: " ",
            COL9: "指急性和亚急气体、烟雾和蒸",
            SIGN: "xxk"
        }, {
            COL11: " ",
            COL2: " ",
            COL3: " ",
            COL1: " ",
            COL6: " ",
            COL7: " ",
            COL4: " ",
            COL5: " ",
            COL8: " ",
            COL9: "汽引起特指急性和亚急气体、",
            SIGN: "xxk"
        }, {
            COL11: " ",
            COL2: " ",
            COL3: " ",
            COL1: " ",
            COL6: " ",
            COL7: " ",
            COL4: " ",
            COL5: " ",
            COL8: " ",
            COL9: "烟雾和蒸",
            SIGN: "xxk"
        }, {
            COL11: " ",
            COL2: "36.6",
            COL3: " ",
            COL1: "18:27",
            COL6: " ",
            COL7: " ",
            COL4: " ",
            COL5: " ",
            COL8: " ",
            SIGN: "xxk",
            COL9: "化学制剂、气体、烟雾和蒸汽"
        }, {
            COL11: " ",
            COL2: " ",
            COL3: " ",
            COL1: " ",
            COL6: " ",
            COL7: " ",
            COL4: " ",
            COL5: " ",
            COL8: " ",
            COL9: "引起蒸汽引起特指急性和亚急",
            SIGN: "xxk"
        }, {
            COL11: " ",
            COL2: " ",
            COL3: " ",
            COL1: " ",
            COL6: " ",
            COL7: " ",
            COL4: " ",
            COL5: " ",
            COL8: " ",
            COL9: "气体、烟雾和蒸汽引起特指急",
            SIGN: "xxk"
        }, {
            COL11: " ",
            COL2: " ",
            COL3: " ",
            COL1: " ",
            COL6: " ",
            COL7: " ",
            COL4: " ",
            COL5: " ",
            COL8: " ",
            COL9: "性和亚急气体、烟雾和蒸汽引",
            SIGN: "xxk"
        }, {
            COL11: " ",
            COL2: " ",
            COL3: " ",
            COL1: " ",
            COL6: " ",
            COL7: " ",
            COL4: " ",
            COL5: " ",
            COL8: " ",
            COL9: "起特指急性和亚急气体、烟雾",
            SIGN: "xxk"
        }, {
            COL11: " ",
            COL2: " ",
            COL3: " ",
            COL1: " ",
            COL6: " ",
            COL7: " ",
            COL4: " ",
            COL5: " ",
            COL8: " ",
            COL9: "和蒸汽引起特指特指急性和亚",
            SIGN: "xxk"
        }, {
            COL11: " ",
            COL2: " ",
            COL3: " ",
            COL1: " ",
            COL6: " ",
            COL7: " ",
            COL4: " ",
            COL5: " ",
            COL8: " ",
            COL9: "急性呼吸性情",
            SIGN: "xxk"
        }],
        patientInfo: {
            deptName: "内科急诊",
            name: "曹操",
            bedNo: "红区",
            diagnosis: "缺氧缺血性脑病",
            age: "28岁",
            sex: "男",
            patientId: "18112610935",
            VISIT_ID: 0,
            PATIENT_ID: "18112610935",
            viewNo: "L1800705",
            admissionDateTime: "2018-11-26",
            admWardDateTime: "2018-11-26 09:42:49",
            dateTime: "2018年11月28日"
        },
        title: "急救中心-记录单",
        tableHeader: [{
            text: "日期",
            cell: 80,
            row: 1,
            colspan: 0,
            rowspan: 0,
            defaultMaxRow: 1,
            defaultMaxColumn: 10,
            SERIAL_NO: 1,
            patientColumnName: "COL11"
        }, {
            text: "时间",
            cell: 40,
            row: 1,
            colspan: 0,
            rowspan: 0,
            defaultMaxRow: 1,
            defaultMaxColumn: 10,
            SERIAL_NO: 2,
            patientColumnName: "COL1"
        }, {
            text: "体温",
            cell: 40,
            row: 1,
            colspan: 0,
            rowspan: 0,
            defaultMaxRow: 1,
            defaultMaxColumn: 10,
            SERIAL_NO: 3,
            patientColumnName: "COL2"
        }, {
            text: "脉搏   (次/分)",
            cell: 35,
            row: 1,
            colspan: 0,
            rowspan: 0,
            defaultMaxRow: 1,
            defaultMaxColumn: 10,
            SERIAL_NO: 4,
            patientColumnName: "COL3"
        }, {
            text: "呼吸   (次/分)",
            cell: 35,
            row: 1,
            colspan: 0,
            rowspan: 0,
            defaultMaxRow: 1,
            defaultMaxColumn: 10,
            SERIAL_NO: 5,
            patientColumnName: "COL4"
        }, {
            text: "血压 (mmHg)",
            cell: 60,
            row: 1,
            colspan: 0,
            rowspan: 0,
            defaultMaxRow: 1,
            defaultMaxColumn: 10,
            SERIAL_NO: 6,
            patientColumnName: "COL5"
        }, {
            text: "SPO2 (%)",
            cell: 30,
            row: 1,
            colspan: 0,
            rowspan: 0,
            defaultMaxRow: 1,
            defaultMaxColumn: 10,
            SERIAL_NO: 7,
            patientColumnName: "COL6"
        }, {
            text: "处理项目",
            cell: 80,
            row: 1,
            colspan: 0,
            rowspan: 0,
            defaultMaxRow: 1,
            defaultMaxColumn: 10,
            SERIAL_NO: 8,
            patientColumnName: "COL7"
        }, {
            text: "尿量(ml)",
            cell: 30,
            row: 1,
            colspan: 0,
            rowspan: 0,
            defaultMaxRow: 1,
            defaultMaxColumn: 10,
            SERIAL_NO: 9,
            patientColumnName: "COL8"
        }, {
            text: "病情记录",
            cell: 190,
            row: 1,
            colspan: 0,
            rowspan: 0,
            defaultMaxRow: 1,
            defaultMaxColumn: 10,
            SERIAL_NO: 10,
            patientColumnName: "COL9"
        }, {
            text: "签名",
            cell: 80,
            row: 1,
            colspan: 0,
            rowspan: 1,
            defaultMaxRow: 1,
            defaultMaxColumn: 10,
            SERIAL_NO: 100000,
            patientColumnName: "SIGN"
        }]
    }
    initHeader(data.tableHeader);
    setBaseInfo(data.patientInfo);
    initBody(data.tableHeader, data.data, JSON.parse(JSON.stringify(data.data[0])));

    document.querySelector(".tdCol").setAttribute('colspan', data.tableHeader[0].defaultMaxColumn + 1)

    function setBaseInfo(data) {
        document.querySelector('.dept').innerHTML = data.deptName || '';
        document.querySelector('.viewNo').innerHTML = data.viewNo || '';
        document.querySelector('.bedNo').innerHTML = data.bedNo || '';
        document.querySelector('.name').innerHTML = data.name || '';
        document.querySelector('.sex').innerHTML = data.sex || '';
        document.querySelector('.age').innerHTML = data.age || '';
        document.querySelector('.admWardDateTime').innerHTML = data.admWardDateTime || '';
        document.querySelector('.disWardDateTime').innerHTML = data.disWardDateTime || '';
        document.querySelector('.dateTime').innerHTML = data.dateTime || '';
        document.querySelector('.diagnosis').innerHTML = data.diagnosis || '';
        document.querySelector('.mainComplaint').innerHTML = data.mainComplaint || '';
    }

    function initHeader(data) {
        let index = 0;
        let html = "";
        for (let a = 0; a < data.length; a++) {
            let d = data[a];
            if (a === 0) {
                html += "<tr>";
                index = d.row
            }
            if (d.row !== index) {
                html += "</tr><tr>"
            }
            html += "<td style='width:" + d.cell + "px' rowspan='" + (d.rowspan + 1) + "' colspan='" + (d.colspan > 0 ? d.colspan : 1) + "'>" + d.text + "</td>";
            index = d.row
        }
        document.getElementById('tableInfo').querySelector('.tableTitle').innerHTML = html + "</tr>"
    }

    function initBody(tableHeader, tableBody, tableVal) {
        let ys = tableBody.length % 13
        if (ys !== 0) {
            for (let i = 0; i < (13 - ys); i++) {
                for (let key in tableVal) {
                    if (tableVal.hasOwnProperty(key)) tableVal[key] = '\n'
                }
                tableBody.push(tableVal)
            }
        }
        let html = '';
        tableBody.forEach(function (v) {
            html += '<tr>';
            tableHeader.forEach(function (header) {
                for (let key in v) {
                    if (v.hasOwnProperty(key) && key.toString().trim() === header.patientColumnName.trim()) {
                        if (v[key].trim().length > 0) {
                            try {
                                let value = JSON.parse(v[key]);
                                if (typeof value === 'object') {
                                    let arr = ''
                                    if (Array.isArray(value)) {
                                        for (let i = 0; i < value.length; i++) {
                                            if (value[i].key) {
                                                arr = value[i].key + ',' + arr
                                            } else {
                                                arr = value[i] + ',' + arr
                                            }
                                        }
                                        arr = arr.slice(0, arr.length - 1)
                                        html += '<td valign="top" class="dot-format">' + arr + '</td>'
                                    } else {
                                        html += '<td valign="top" class="dot-format">' + (value.key || '') + '</td>'
                                    }
                                } else {
                                    html += '<td valign="top" class="dot-format">' + (v[key] || '') + '</td>'
                                }
                            } catch (erre) {
                                html += '<td valign="top" class="dot-format">' + (v[key] || '') + '</td>'
                            }
                        } else {
                            html += '<td valign="top" class="dot-format">' + (v[key] || '') + '</td>'
                        }
                    }
                }
            });
            html += '</tr>'
        });
        document.querySelector('.tableBody').innerHTML = html
    }
</script>
</body>
</html>